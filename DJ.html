<!DOCTYPE html>
<html lang="en" ng-app="myApp">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HINDUSTAN TOYS ORDER PORTAL</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css">
  <link rel="stylesheet" href="https://fezvrasta.github.io/bootstrap-material-design/dist/css/bootstrap-material-design.css">
  <link rel="stylesheet" href="https://fezvrasta.github.io/bootstrap-material-design/dist/css/ripples.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
  <style>
    body {
      font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
      font-size: 16px;
      line-height: 1.5;
      color: #333;
      background-color: #fff;
      overscroll-behavior-y: none;
      margin: 0;
    }

    html {
      font-size: 10px;
      -webkit-tap-highlight-color: rgba(0,0,0,0);
    }

    /* Login Container */
    #login-container {
      background-image: url(https://hunkaammy.github.io/mywebsite/NEWWEBSITE/loginpg.jpeg);
      background-size: cover;
      height: 100vh;
      max-width: 100%;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    #inside {
      background-color: rgba(255, 255, 255, 0.9);
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      text-align: center;
      width: 100%;
      max-width: 400px;
    }

    input {
      width: 100%;
      padding: 12px;
      margin-bottom: 15px;
      box-sizing: border-box;
      font-size: 16px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }

    button {
      width: 100%;
      padding: 12px;
      background-color: #4caf50;
      color: #fff;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 16px;
    }

    button:hover {
      background-color: #45a049;
    }

    /* Navbar */
    .navbar {
      background-color: white;
      padding: 10px;
      position: fixed;
      width: 100%;
      top: 0;
      z-index: 1000;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .navbar .search-container {
      display: flex;
      align-items: center;
      flex-wrap: wrap;
      gap: 10px;
    }

    #topBtn {
      flex: 1;
      padding: 10px;
      font-size: 14px;
      border-radius: 6px;
      border: 1px solid #ccc;
    }

    .sort-dropdown {
      padding: 10px;
      font-size: 14px;
      border-radius: 6px;
    }

    .logout-btn {
      color: #333;
      font-size: 14px;
      cursor: pointer;
      padding: 10px;
    }

    .welcome-text {
      text-align: center;
      color: #333;
      font-size: 16px;
      margin-top: 10px;
      font-family: system-ui, sans-serif;
    }

    /* Product Grid */
    .skeleton-wrapper {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
      width: 90%;
      margin: 100px auto 20px auto;
      padding: 0 10px;
    }

    @media (max-width: 768px) {
      .skeleton-wrapper {
        grid-template-columns: 1fr;
      }
    }

    .card {
      box-shadow: 0 4px 8px rgba(0,0,0,0.2);
      transition: box-shadow 0.3s;
      width: 100%;
      max-width: 300px;
      margin: 0 auto;
      border: 1px solid #ccc;
      border-radius: 8px;
      text-align: center;
      background: white;
    }

    .card:hover {
      box-shadow: 0 8px 16px rgba(0,0,0,0.2);
    }

    .card img {
      width: 100%;
      max-width: 200px;
      height: auto;
      margin: 10px auto;
      border: 1px solid lightgrey;
      border-radius: 8px;
      object-fit: cover;
    }

    @media (max-width: 768px) {
      .card img {
        max-width: 150px;
      }
    }

    .containers {
      padding: 10px;
    }

    .qtyclass {
      height: 40px;
      width: 60px;
      margin: 10px 5px 0 0;
      font-size: 14px;
      border-radius: 6px;
    }

    .submit {
      cursor: pointer;
      background: white;
      color: green;
      font-weight: 700;
      width: 60px;
      height: 40px;
      border: 1px solid grey;
      border-radius: 6px;
      margin: 10px 0 0 5px;
      font-size: 14px;
    }

    .btn-primary {
      position: fixed;
      bottom: 20px;
      right: 20px;
      color: #fff;
      background-color: #337ab7;
      border-color: #2e6da4;
      z-index: 1;
      padding: 10px 20px;
      font-size: 16px;
    }

    p {
      margin: 0 0 5px;
      white-space: nowrap;
      text-overflow: ellipsis;
      overflow: hidden;
      font-size: 14px;
    }

    /* Enlarged Image */
    .enlarged-image-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }

    .enlarged-image img {
      max-width: 90%;
      max-height: 90%;
      width: auto;
      height: auto;
    }

    .enlarged-image button {
      position: absolute;
      top: 15px;
      right: 15px;
      background-color: transparent;
      color: white;
      border: none;
      cursor: pointer;
      font-size: 20px;
    }

    /* Tabs */
    .tab-scroll-wrapper {
      margin-top: 70px;
      overflow-y: auto;
      height: calc(100vh - 70px);
      position: fixed;
      width: 90px;
      background: #f5f5f5;
      padding: 10px 5px;
    }

    .tab-items {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .tab-item {
      width: 80px;
      height: 100px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      background-color: white;
      border-radius: 8px;
      text-align: center;
      font-family: Arial, sans-serif;
      font-size: 10px;
      color: #333;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      transition: background-color 0.2s;
    }

    .tab-item.active {
      background-color: #5A55A3;
      color: white;
      font-weight: bold;
      height: 110px;
    }

    .tab-item img {
      width: 50px;
      height: 50px;
      object-fit: cover;
      margin: 5px auto;
    }

    .tab-scroll-wrapper::-webkit-scrollbar {
      width: 6px;
    }

    .tab-scroll-wrapper::-webkit-scrollbar-thumb {
      background-color: #ccc;
      border-radius: 3px;
    }

    .tab-scroll-wrapper::-webkit-scrollbar-track {
      background-color: #f1f1f1;
    }

    /* Skeleton Loading */
    .skeleton-item {
      width: 100%;
      max-width: 300px;
      height: 300px;
      background-color: #f0f0f0;
      border-radius: 8px;
      overflow: hidden;
      position: relative;
      animation: skeleton-pulse 1.5s ease-in-out infinite;
      margin: 0 auto;
    }

    @keyframes skeleton-pulse {
      0% { opacity: 0.6; }
      50% { opacity: 1; }
      100% { opacity: 0.6; }
    }

    .skeleton-item .skeleton-text {
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      padding: 15px;
    }

    .skeleton-item .skeleton-line {
      width: 100%;
      height: 14px;
      background-color: #e0e0e0;
      margin-bottom: 10px;
      border-radius: 4px;
    }

    /* Microphone Animation */
    @keyframes pulse {
      0% { transform: scale(1); color: black; }
      50% { transform: scale(1.2); color: blue; }
      100% { transform: scale(1); color: black; }
    }

    #micIcon.animating {
      animation: pulse 1s infinite;
    }
  </style>
</head>
<body ng-controller="imagesController as vm">
  <!-- Prevent Browser Back -->
  <script>
    history.pushState(null, null, location.href);
    window.onpopstate = function () {
      history.go(1);
    };
  </script>

  <!-- Login Section -->
  <div id="login-container">
    <div id="inside">
      <h2 style="font-size: 20px; margin-bottom: 20px;">WELCOME TO HINDUSTAN TOYS</h2>
      <input type="text" id="name" ng-model="dynamicField2Value" placeholder="Enter your shop name" autocomplete="off">
      <input type="tel" id="mobile" placeholder="Enter your mobile number" autocomplete="off">
      <button onclick="validateLogin()">Login</button>
    </div>
  </div>

  <!-- Main Content -->
  <div id="content" style="display: none;">
    <!-- Navbar -->
    <div class="navbar">
      <div class="search-container">
        <input type="text" ng-model="searchQuery" placeholder="Search by product" id="topBtn" ng-click="resetFilters()" list="productNames">
        <datalist id="productNames">
          <option value="REMOTE CAR"></option>
          <option value="JCB"></option>
          <option value="CLAY"></option>
          <option value="SLIME"></option>
          <option value="GUN"></option>
          <option value="BASKET BALL"></option>
        </datalist>
        <i id="micIcon" class="fas fa-microphone" onclick="startVoiceRecognition()" style="font-size: 20px; cursor: pointer; margin-left: 10px;"></i>
        <div class="logout-btn" ng-click="logout()">Logout</div>
        <div>
          <label for="sort" style="font-size: 14px;">Sort by:</label>
          <select id="sort" ng-model="sortOrder" ng-change="scrollToTop(); applyFilter()" ng-init="sortOrder='-date'" class="sort-dropdown">
            <option value="-date">NEW</option>
            <option value="price">LOW</option>
            <option value="-price">HIGH</option>
          </select>
        </div>
      </div>
      <div class="welcome-text">Welcome {{dynamicField2Value}}</div>
    </div>

    <!-- Tabs -->
    <div class="tab-scroll-wrapper">
      <div class="tab-items" onclick="scrollToTop()">
        <div class="tab-item" ng-click="setTab('', 0)" ng-class="{ 'active': activeTab === 0 }">
          <img src="https://www.hindustantoys.in/images/all.jpeg" alt="All Products"> ALL PRODUCTS
        </div>
        <div class="tab-item" ng-click="setTab('UMBRELLA', 38)" ng-class="{ 'active': activeTab === 38 }">
          <img src="https://firebasestorage.googleapis.com/v0/b/htshop-e9c51.appspot.com/o/2024-06-24T16%3A35%3A31.407Z_RAINBOW%20UMBRELLA_IMG-20240529-WA0047.jpg?alt=media&token=64ee5147-65c7-4de8-897d-55df6cb84857" alt="Umbrella"> UMBRELLA
        </div>
        <div class="tab-item" ng-click="setTab('LUMO', 10)" ng-class="{ 'active': activeTab === 10 }">
          <img src="https://www.hindustantoys.in/images/lumo.jpeg" alt="Lumo Products"> LUMO & OTHER
        </div>
        <div class="tab-item" ng-click="setTab('BAT BALL', 36)" ng-class="{ 'active': activeTab === 36 }">
          <img src="https://www.hindustantoys.in/images/bat.jpeg" alt="Bat Ball"> BAT BALL & SET
        </div>
        <div class="tab-item" ng-click="setTab('CARROM', 35)" ng-class="{ 'active': activeTab === 35 }">
          <img src="https://www.hindustantoys.in/images/carrom.jpeg" alt="Carrom Board"> CARROM BOARD
        </div>
        <div class="tab-item" ng-click="setTab('SWING', 37)" ng-class="{ 'active': activeTab === 37 }">
          <img src="https://www.hindustantoys.in/images/swing.jpeg" alt="Swings"> SWINGS
        </div>
        <div class="tab-item" ng-click="setTab('INDIAN TOYS', 3)" ng-class="{ 'active': activeTab === 3 }">
          <img src="https://www.hindustantoys.in/images/JCB.jpeg" alt="Indian Toys"> INDIAN TOYS
        </div>
        <div class="tab-item" ng-click="setTab('MIX', 9)" ng-class="{ 'active': activeTab === 9 }">
          <img src="https://www.hindustantoys.in/images/mix.jpeg" alt="Mix Toys"> MIX TOYS
        </div>
        <div class="tab-item" ng-click="setTab('BATTERY', 13)" ng-class="{ 'active': activeTab === 13 }">
          <img src="https://www.hindustantoys.in/images/battery.jpeg" alt="Battery Operated"> BATTERY OPERATED
        </div>
        <div class="tab-item" ng-click="setTab('TEDDY', 34)" ng-class="{ 'active': activeTab === 34 }">
          <img src="https://www.hindustantoys.in/images/TEDDY.jpg" alt="Teddy"> VALENTINES/TEDDY
        </div>
        <div class="tab-item" ng-click="setTab('KITCHEN', 31)" ng-class="{ 'active': activeTab === 31 }">
          <img src="https://www.hindustantoys.in/images/KITCHEN.jpg" alt="Kitchen Sets"> KITCHEN SETS
        </div>
        <div class="tab-item" ng-click="setTab('RACKET', 6)" ng-class="{ 'active': activeTab === 6 }">
          <img src="https://www.hindustantoys.in/images/racket.jpeg" alt="Racket"> RACKET
        </div>
        <div class="tab-item" ng-click="setTab('REMOTE', 7)" ng-class="{ 'active': activeTab === 7 }">
          <img src="https://www.hindustantoys.in/images/remote.jpeg" alt="Remote Car"> REMOTE CAR
        </div>
        <div class="tab-item" ng-click="setTab('RIDDER', 11)" ng-class="{ 'active': activeTab === 11 }">
          <img src="https://www.hindustantoys.in/images/ridder.jpeg" alt="Magic Ridder"> MAGIC RIDDER
        </div>
        <div class="tab-item" ng-click="setTab('HIGH QUALITY', 25)" ng-class="{ 'active': activeTab === 25 }">
          <img src="https://www.hindustantoys.in/images/high.jpeg" alt="High Quality Indian Toys"> HIGH QUALITY
        </div>
        <div class="tab-item" ng-click="setTab('OWN', 30)" ng-class="{ 'active': activeTab === 30 }">
          <img src="https://www.hindustantoys.in/images/htquality.jpg" alt="HT Products"> HT PRODUCTS
        </div>
        <div class="tab-item" ng-click="setTab('PALNA', 29)" ng-class="{ 'active': activeTab === 29 }">
          <img src="https://www.hindustantoys.in/images/palna.png" alt="Palna"> PALNA
        </div>
        <div class="tab-item" ng-click="setTab('WALKER', 5)" ng-class="{ 'active': activeTab === 5 }">
          <img src="https://www.hindustantoys.in/images/walker.jpeg" alt="Walker"> WALKER
        </div>
        <div class="tab-item" ng-click="setTab('LUNCH BOX', 28)" ng-class="{ 'active': activeTab === 28 }">
          <img src="https://www.hindustantoys.in/images/DUMMY.jpeg" alt="Lunch Box"> LUNCH BOX
        </div>
        <div class="tab-item" ng-click="setTab('PENCIL BOX', 27)" ng-class="{ 'active': activeTab === 27 }">
          <img src="https://www.hindustantoys.in/images/DUMMY.jpeg" alt="Pencil Box"> PENCIL BOX
        </div>
        <div class="tab-item" ng-click="setTab('BOTTLE', 23)" ng-class="{ 'active': activeTab === 23 }">
          <img src="https://www.hindustantoys.in/images/DUMMY.jpeg" alt="Water Bottle"> WATER BOTTLE
        </div>
        <div class="tab-item" ng-click="setTab('BOARD GAME', 26)" ng-class="{ 'active': activeTab === 26 }">
          <img src="https://www.hindustantoys.in/images/DUMMY.jpeg" alt="Board Game"> BOARD GAME
        </div>
        <div class="tab-item" ng-click="setTab('EDUCATIONAL', 22)" ng-class="{ 'active': activeTab === 22 }">
          <img src="https://www.hindustantoys.in/images/DUMMY.jpeg" alt="Educational Toys"> EDUCATIONAL
        </div>
        <div class="tab-item" ng-click="setTab('BIG', 21)" ng-class="{ 'active': activeTab === 21 }">
          <img src="https://www.hindustantoys.in/images/DUMMY.jpeg" alt="Big Items"> BIG
        </div>
        <div class="tab-item" ng-click="setTab('STUDY TABLE', 20)" ng-class="{ 'active': activeTab === 20 }">
          <img src="https://www.hindustantoys.in/images/DUMMY.jpeg" alt="Study Table"> STUDY TABLE
        </div>
        <div class="tab-item" ng-click="setTab('TRICYCLE', 19)" ng-class="{ 'active': activeTab === 19 }">
          <img src="https://www.hindustantoys.in/images/DUMMY.jpeg" alt="Tricycles"> TRICYCLES
        </div>
        <div class="tab-item" ng-click="setTab('SPORTS', 18)" ng-class="{ 'active': activeTab === 18 }">
          <img src="https://www.hindustantoys.in/images/DUMMY.jpeg" alt="Sports Item"> SPORTS ITEM
        </div>
        <div class="tab-item" ng-click="setTab('PATTA', 17)" ng-class="{ 'active': activeTab === 17 }">
          <img src="https://www.hindustantoys.in/images/DUMMY.jpeg" alt="Patta Items"> PATTA ITEMS
        </div>
        <div class="tab-item" ng-click="setTab('GUN', 15)" ng-class="{ 'active': activeTab === 15 }">
          <img src="https://www.hindustantoys.in/images/DUMMY.jpeg" alt="Guns Variety"> GUNS VARIETY
        </div>
        <div class="tab-item" ng-click="setTab('STATIONERY', 1)" ng-class="{ 'active': activeTab === 1 }">
          <img src="https://www.hindustantoys.in/images/DUMMY.jpeg" alt="Stationery Items"> STATIONERY
        </div>
        <div class="tab-item" ng-click="setTab('DOLL', 8)" ng-class="{ 'active': activeTab === 8 }">
          <img src="https://www.hindustantoys.in/images/DUMMY.jpeg" alt="Doll"> DOLL
        </div>
        <div class="tab-item" ng-click="setTab('FANCY', 12)" ng-class="{ 'active': activeTab === 12 }">
          <img src="https://www.hindustantoys.in/images/DUMMY.jpeg" alt="Fancy Items"> FANCY ITEMS
        </div>
        <div class="tab-item" ng-click="setTab('DOZEN', 14)" ng-class="{ 'active': activeTab === 14 }">
          <img src="https://www.hindustantoys.in/images/DUMMY.jpeg" alt="Dozen Packing"> DOZEN PACKING
        </div>
        <div class="tab-item" ng-click="setTab('G1', 32)" ng-class="{ 'active': activeTab === 32 }">
          <img src="https://www.hindustantoys.in/images/DUMMY.jpeg" alt="Godown-1"> GODOWN-1
        </div>
        <div class="tab-item" ng-click="setTab('G2', 33)" ng-class="{ 'active': activeTab === 33 }">
          <img src="https://www.hindustantoys.in/images/DUMMY.jpeg" alt="Godown-2"> GODOWN-2
        </div>
        <div class="tab-item" ng-click="setTab('GUN', 16)" ng-class="{ 'active': activeTab === 16 }">
          <img src="https://www.hindustantoys.in/images/DUMMY.jpeg" alt="Empty"> EMPTY
        </div>
      </div>
    </div>

    <!-- Product Grid -->
    <div class="skeleton-wrapper" ng-if="vm.images.length === 0">
      <div class="skeleton-item" ng-repeat="n in [].constructor(4) track by $index">
        <div class="skeleton-text">
          <div class="skeleton-line"></div>
          <div class="skeleton-line"></div>
          <div class="skeleton-line" style="width: 80%;"></div>
          <div class="skeleton-line" style="width: 50%;"></div>
        </div>
      </div>
    </div>

    <div class="skeleton-wrapper" ng-if="vm.images.length > 0">
      <div ng-repeat="image in vm.images | orderBy: sortOrder | filter: { name: productNameFilter } | filter:searchQuery">
        <div ng-if="!image.outOfStock">
          <div class="card">
            <img src="{{image.url}}" alt="{{image.name}}" onclick="enlargeImage(this.src)" loading="lazy">
            <div id="enlarged-image-container" class="enlarged-image-container" style="display: none;">
              <div class="enlarged-image">
                <img id="enlarged-img" src="" alt="Enlarged Image">
                <button onclick="closeEnlarged()">✖</button>
              </div>
            </div>
            <button ng-if="!image.outOfStock && dynamicField2Value === 'sammyadmin'" class="btn btn-warning btn-sm" ng-click="markOutOfStock(image)" style="margin: 5px 0;">
              Mark Out of Stock
            </button>
            <div class="containers">
              <h4><b><p>{{image.price}} Rs.</p></b></h4>
              <p>{{image.name}}</p>
              <p><a href="https://hunkaammy.github.io/mywebsite/videos/{{image.videourl}}.mp4" target="_blank" ng-if="image.videourl">Watch Video</a></p>
              <input type="hidden" id="{{'inputa' + $index}}" ng-model="image.url">
              <input type="hidden" id="{{'inputb' + $index}}" ng-model="dynamicField2Value" ng-value="dynamicField2Value">
              <input type="number" class="qtyclass" id="{{'inputc' + $index}}" placeholder="Qty" ng-model="image.field3" ng-change="submitData(image, $index)" ng-model-options="{ debounce: 500 }">
              <p ng-show="showItemAdded" style="color: green;">Item Added</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Order Modal -->
    <div class="container mt-3">
      <button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#myModal">Your Order</button>
    </div>
    <div class="modal" id="myModal">
      <div class="modal-dialog modal-fullscreen">
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title">{{dynamicField2Value}} Your Order List</h4>
            <button type="button" class="btn-close" data-bs-dismiss="modal">Close</button>
          </div>
          <div class="modal-body">
            <object data="https://hunkaammy.github.io/mywebsite/NEWWEBSITE/order1#myInput={{dynamicField2Value}}" width="100%" height="400">
              <embed src="https://hunkaammy.github.io/mywebsite/cart#myInput=samrat" width="100%" height="400"> </embed>
              Error: Embedded data could not be displayed.
            </object>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-danger" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.lazyload/1.9.7/jquery.lazyload.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
  <script src="https://cdn.firebase.com/libs/angularfire/2.1.0/angularfire.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.js"></script>
  <script src="https://fezvrasta.github.io/bootstrap-material-design/dist/js/material.min.js"></script>

  <script>
    var firebaseConfig = {
      apiKey: "AIzaSyAr8dYBz_D1DVnGfT_fQhTwD1YmtTvuzMk",
      authDomain: "shop-reminder-3ce10.firebaseapp.com",
      databaseURL: "https://shop-reminder-3ce10-default-rtdb.firebaseio.com",
      projectId: "shop-reminder-3ce10",
      storageBucket: "shop-reminder-3ce10.appspot.com",
      messagingSenderId: "555627569260",
      appId: "1:555627569260:web:3948ae391eab6eb5ea7849",
      measurementId: "G-BP5EYR6ET1"
    };
    firebase.initializeApp(firebaseConfig);

    var blockedNumbers = ['7000913701', '9876543210', '9123456789', '8987854256', '9039199794'];
    function validateLogin() {
      var name = document.getElementById('name').value.trim();
      var mobile = document.getElementById('mobile').value.trim();
      if (name.length < 4) {
        alert('Please enter a valid shop name.');
        return;
      }
      if (!/^[6-9]\d{9}$/.test(mobile)) {
        alert('Please enter a valid mobile number.');
        return;
      }
      if (blockedNumbers.includes(mobile)) {
        window.location.href = '/mywebsite/NEWWEBSITE/blocked.html';
        return;
      }
      var lowerName = name.toLowerCase();
      if (lowerName === 'mohit chawla' || lowerName === 'honey digital' || lowerName === 'bab el mandeb' || lowerName === 'saha resources') {
        window.location.href = '/mywebsite/NEWWEBSITE/blocked.html';
        return;
      }
      var database = firebase.database();
      var userRef = database.ref('users').push({
        name: name,
        mobile: mobile,
        timestamp: firebase.database.ServerValue.TIMESTAMP
      });
      localStorage.setItem('name', name);
      localStorage.setItem('mobile', mobile);
      localStorage.setItem('loggedIn', 'true');
      document.getElementById('login-container').style.display = 'none';
      document.getElementById('content').style.display = 'block';
    }

    function autoLogin() {
      var storedName = localStorage.getItem('name');
      var storedMobile = localStorage.getItem('mobile');
      if (storedMobile === '7000913701' || (storedName && storedName.toLowerCase() === 'mohit chawla')) {
        return;
      }
      if (storedName && storedMobile) {
        document.getElementById('name').value = storedName;
        document.getElementById('mobile').value = storedMobile;
        validateLogin();
      }
    }

    function logout() {
      localStorage.removeItem('name');
      localStorage.removeItem('mobile');
      localStorage.removeItem('loggedIn');
      window.location.href = 'https://hindustantoys.in/pagdi';
    }

    window.onload = autoLogin;

    function enlargeImage(src) {
      var enlargedImg = document.getElementById('enlarged-img');
      var enlargedContainer = document.getElementById('enlarged-image-container');
      enlargedImg.src = src;
      enlargedContainer.style.display = 'flex';
    }

    function closeEnlarged() {
      var enlargedContainer = document.getElementById('enlarged-image-container');
      enlargedContainer.style.display = 'none';
    }

    document.getElementById('enlarged-image-container')?.addEventListener('click', function(event) {
      if (event.target === event.currentTarget) {
        closeEnlarged();
      }
    });

    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    const images = document.querySelectorAll('img');
    for (let img of images) {
      img.onload = ({ target }) => setTimeout(() => { target.classList.add('loaded') }, 200);
    }

    document.addEventListener('DOMContentLoaded', function() {
      var selectElement = document.getElementById('sort');
      if (selectElement) {
        selectElement.addEventListener('change', function() {
          scrollToTop();
        });
      }
    });

    function startVoiceRecognition() {
      const micIcon = document.getElementById('micIcon');
      micIcon.classList.add('animating');
      const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
      recognition.lang = 'en-US';
      recognition.onresult = function(event) {
        const transcript = event.results[0][0].transcript;
        document.getElementById('topBtn').value = transcript;
        angular.element(document.getElementById('topBtn')).scope().$apply(function($scope) {
          $scope.searchQuery = transcript;
        });
        filterData(transcript);
        scrollToTop();
        setTimeout(function() {
          micIcon.classList.remove('animating');
        }, 500);
      };
      recognition.start();
    }

    function filterData(query) {
      angular.element(document.getElementById('topBtn')).scope().$apply(function($scope) {
        $scope.productNameFilter = query;
      });
    }
  </script>

  <script>
    var app = angular.module('myApp', ['firebase']);
    app.controller('imagesController', function($scope, $firebaseArray, $window, $location) {
      $scope.vm = this;
      $scope.vm.images = [];
      $scope.sortOrder = '';
      $scope.dynamicField2Value = localStorage.getItem('name');
      var firebaseConfigFetch = {
        apiKey: "AIzaSyAvlig_xWJNP1hFsl4qfisC01VTkOAVhT8",
        authDomain: "htshop-e9c51.firebaseapp.com",
        databaseURL: "https://htshop-e9c51-default-rtdb.firebaseio.com",
        projectId: "htshop-e9c51",
        storageBucket: "htshop-e9c51.appspot.com",
        messagingSenderId: "653137640907",
        appId: "1:653137640907:web:672fd6a9e85ca448a70a4e",
        measurementId: "G-FJ4Q0FHBEG"
      };
      var firebaseConfigSubmit = {
        apiKey: "AIzaSyAMFjDnZaszneoR6nO8bmXUxwZJplLvNfU",
        authDomain: "notes-12519.firebaseapp.com",
        databaseURL: "https://notes-12519-default-rtdb.firebaseio.com",
        projectId: "notes-12519",
        storageBucket: "notes-12519.appspot.com",
        messagingSenderId: "1073774450189",
        appId: "1:1073774450189:web:0b6d4a9f95823abbf36744",
        measurementId: "G-GZXYCJ33TR"
      };
      var firebaseFetch = firebase.initializeApp(firebaseConfigFetch, 'fetchApp');
      var firebaseSubmit = firebase.initializeApp(firebaseConfigSubmit, 'submitApp');
      var databaseFetch = firebaseFetch.database().ref();
      var listFetch = $firebaseArray(databaseFetch);
      $scope.vm.images = listFetch;
      var databaseSubmit = firebaseSubmit.database().ref();
      var listSubmit = $firebaseArray(databaseSubmit);

      function getUrlParameter(name) {
        name = name.replace(/[\[]/, '\\[').replace(/[\]]/, '\\]');
        var regex = new RegExp('[\\?&]' + name + '=([^&#]*)');
        var results = regex.exec($location.absUrl());
        return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g, ' '));
      }

      var filterParam = getUrlParameter('filter');
      var tabParam = getUrlParameter('tab');
      $scope.productNameFilter = filterParam || '';
      $scope.activeTab = isNaN(tabParam) ? 0 : parseInt(tabParam, 10);

      $scope.setTab = function(filter, tab) {
        $scope.productNameFilter = filter;
        $scope.activeTab = tab;
        $scope.searchQuery = '';
        $location.search('filter', filter);
        $location.search('tab', tab);
        scrollToTop();
      };

      $scope.resetFilters = function() {
        $scope.productNameFilter = '';
        $scope.activeTab = 0;
        $scope.searchQuery = '';
        $location.search('filter', '');
        $location.search('tab', 0);
        scrollToTop();
      };

      $scope.submitData = function(image, index) {
        var inputa = image.url;
        var inputb = $scope.dynamicField2Value;
        var inputc = image.field3;
        var currentDate = new Date();
        var day = String(currentDate.getDate()).padStart(2, '0');
        var month = String(currentDate.getMonth() + 1).padStart(2, '0');
        var year = currentDate.getFullYear();
        var submitDate = day + '-' + month + '-' + year;
        var hours = currentDate.getHours();
        var minutes = String(currentDate.getMinutes()).padStart(2, '0');
        var ampm = hours >= 12 ? 'PM' : 'AM';
        hours = hours % 12;
        hours = hours ? hours : 12;
        var submitTime = hours + ':' + minutes + ' ' + ampm;

        if (image.quantityId) {
          databaseSubmit.child(image.quantityId).update({
            field3: inputc
          }).then(() => {
            $scope.showItemAdded = true;
            setTimeout(() => { $scope.$apply(() => { $scope.showItemAdded = false; }); }, 2000);
          }).catch((error) => {
            console.log("Error updating quantity:", error);
          });
        } else {
          var newDataKey = databaseSubmit.push().key;
          image.quantityId = newDataKey;
          databaseSubmit.child(newDataKey).set({
            field1: inputa,
            field2: inputb,
            field3: inputc,
            productName: image.name,
            productPrice: image.price,
            submitDate: submitDate,
            submitTime: submitTime,
            submittedDate: firebase.database.ServerValue.TIMESTAMP
          }).then(() => {
            $scope.showItemAdded = true;
            setTimeout(() => { $scope.$apply(() => { $scope.showItemAdded = false; }); }, 2000);
          }).catch((error) => {
            console.log("Error adding item:", error);
          });
        }
      };

      $scope.markOutOfStock = function(image) {
        var databaseRef = firebaseFetch.database().ref(image.$id);
        databaseRef.update({
          outOfStock: true,
          lastModified: firebase.database.ServerValue.TIMESTAMP
        }).then(function() {
          image.outOfStock = true;
          image.lastModified = Date.now();
        }).catch(function(error) {
          console.error("Error updating stock status:", error);
        });
      };

      $scope.logout = function() {
        localStorage.removeItem('name');
        localStorage.removeItem('mobile');
        localStorage.removeItem('loggedIn');
        $window.location.href = '/mywebsite/index.html';
      };

      $scope.applyFilter = function() {
        // Placeholder for filter application
      };
    });

    angular.module('myApp').directive('customOnChange', function() {
      return {
        restrict: 'A',
        link: function(scope, element, attrs) {
          var onChangeHandler = scope.$eval(attrs.customOnChange);
          element.bind('change', onChangeHandler);
        }
      };
    });
  </script>
</body>
</html>

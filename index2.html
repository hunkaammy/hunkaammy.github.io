<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Non-Stop Sync Radio</title>
</head>
<body>
  <audio id="player" controls></audio>
  <p>Now playing: <span id="track-name">Loading...</span></p>

  <script>
    // Playlist with your URLs and estimated durations
    const playlist = [
      { 
        url: "https://pagalfree.com/download/128-Shopping%20List%20-%20Yo%20Yo%20Honey%20Singh%20128%20Kbps.mp3", 
        duration: 180, // 3:00 - Adjust if needed
        name: "Shopping List - Yo Yo Honey Singh" 
      },
      { 
        url: "https://pagalfree.com/download/128-Tauba%20Tauba%20-%20Bad%20Newz%20128%20Kbps.mp3", 
        duration: 210, // 3:30 - Adjust if needed
        name: "Tauba Tauba - Bad Newz" 
      },
      { 
        url: "https://pagalfree.com/download/128-Mere%20Mehboob%20Mere%20Sanam%20-%20Bad%20Newz%20128%20Kbps.mp3", 
        duration: 195, // 3:15 - Adjust if needed
        name: "Mere Mehboob Mere Sanam - Bad Newz" 
      }
    ];

    // Start time: April 10, 2025, 12:00:00 UTC
    const startTime = new Date("2025-04-10T12:00:00Z").getTime();
    const totalDuration = playlist.reduce((sum, track) => sum + track.duration, 0); // 585s (9:45)

    const audio = document.getElementById("player");
    let nextAudio = new Audio(); // Preload next track
    let currentTrackIndex = -1; // Track current index

    function syncRadio() {
      const trackNameDisplay = document.getElementById("track-name");

      // Calculate elapsed time and loop
      let elapsed = (Date.now() - startTime) / 1000;
      elapsed = elapsed % totalDuration;
      if (elapsed < 0) elapsed += totalDuration;

      // Find current track and position
      let newTrackIndex = 0;
      let timeInPlaylist = 0;
      for (let i = 0; i < playlist.length; i++) {
        if (elapsed < timeInPlaylist + playlist[i].duration) {
          newTrackIndex = i;
          break;
        }
        timeInPlaylist += playlist[i].duration;
      }
      const position = elapsed - timeInPlaylist;
      const currentTrack = playlist[newTrackIndex];

      // Switch track if needed
      if (newTrackIndex !== currentTrackIndex) {
        audio.src = currentTrack.url;
        audio.currentTime = position;
        audio.play().catch(err => console.log("Playback error:", err));
        currentTrackIndex = newTrackIndex;

        // Preload next track
        const nextTrackIndex = (currentTrackIndex + 1) % playlist.length;
        nextAudio.src = playlist[nextTrackIndex].url;
      } else if (Math.abs(audio.currentTime - position) > 0.3) {
        audio.currentTime = position; // Sync within 0.3s
      }

      // Display with current date
      const currentDate = new Date().toLocaleDateString();
      trackNameDisplay.textContent = `${currentTrack.name} - ${currentDate}`;

      // Ensure non-stop playback
      if (audio.paused) audio.play().catch(err => console.log("Playback error:", err));

      // Sync every 100ms
      setTimeout(syncRadio, 100);
    }



    syncRadio();
  </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sync Radio</title>
</head>
<body>
  <audio id="player" controls></audio>
  <p>Now playing: <span id="track-name">Loading...</span></p>

  <script>
    // Playlist with your URLs and estimated durations
    const playlist = [
      { 
        url: "https://p320.djpunjab.is/data/128/57279/307096/Behave%20Yourself%20-%20Navjeet.mp3", 
        duration: 210, // 3:30 - Adjust if needed
        name: "Behave Yourself - Navjeet" 
      },
      { 
        url: "https://p320.djpunjab.is/data/128/57129/306850/DAND%20MARDE%20-%20Veer%20Sandhu.mp3", 
        duration: 180, // 3:00 - Adjust if needed
        name: "DAND MARDE - Veer Sandhu" 
      }
    ];

    // Start time: April 10, 2025, 12:00:00 UTC
    const startTime = new Date("2025-04-10T12:00:00Z").getTime();
    const totalDuration = playlist.reduce((sum, track) => sum + track.duration, 0); // 390s (6:30)

    function syncRadio() {
      const audio = document.getElementById("player");
      const trackNameDisplay = document.getElementById("track-name");

      // Calculate elapsed time and loop
      let elapsed = (Date.now() - startTime) / 1000;
      elapsed = elapsed % totalDuration;
      if (elapsed < 0) elapsed += totalDuration;

      // Find current track and position
      let currentTrackIndex = 0;
      let timeInPlaylist = 0;
      for (let i = 0; i < playlist.length; i++) {
        if (elapsed < timeInPlaylist + playlist[i].duration) {
          currentTrackIndex = i;
          break;
        }
        timeInPlaylist += playlist[i].duration;
      }
      const position = elapsed - timeInPlaylist;
      const currentTrack = playlist[currentTrackIndex];

      // Sync audio
      if (audio.src !== currentTrack.url) {
        audio.src = currentTrack.url;
        audio.currentTime = position;
      } else if (Math.abs(audio.currentTime - position) > 1) {
        audio.currentTime = position; // Correct drift
      }

      // Display with current date
      const currentDate = new Date().toLocaleDateString();
      trackNameDisplay.textContent = `${currentTrack.name} - ${currentDate}`;

      // Play if paused
      if (audio.paused) audio.play().catch(err => console.log("Playback error:", err));

      // Check sync every 0.5s
      setTimeout(syncRadio, 500);
    }

    syncRadio();
  </script>
</body>
</html>
